---
title: Requests table
description: Reference docs for the httparchive.all.requests table
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

[`httparchive.all.requests`](https://console.cloud.google.com/bigquery?ws=!1m5!1m4!4m3!1shttparchive!2sall!3srequests) is a partitioned and clustered table containing one row per request per page tested in the HTTP Archive. Pages are tested on a monthly basis and as of April 2022, both the root page and one secondary page are tested.

## Example queries

Here are some common operations you can perform with the `requests` table.

### Count the pages crawled

<Tabs>
  <TabItem label="Query">

  ```sql
  /* This query will process 85 GB when run. */
  SELECT
    client,
    is_root_page,
    count(0) AS requests_total
  FROM `httparchive.all.requests`
  WHERE date = "2024-05-01"
  group by client, is_root_page
  ```

  </TabItem>
  <TabItem label="Results">

  client | is_root_page | requests_total
  -- | -- | --
  mobile | true | 1517364094
  desktop | true | 1299394354
  mobile | false | 1216156430
  desktop | false | 1093804725

  </TabItem>
</Tabs>

### Size of requests served

<Tabs>
  <TabItem label="Query">

  Let's check the size of individual requests served from websites across the entire dataset. To do this, we'll be using the respBodySize summary metric. This metric represents the size of the response payload in bytes. Since 1 byte is very granular, we'll divide by 1024 to get to 1 KB and then by 100 so that we are looking at this data with bin sizes of 100KB. We'll also wrap this in a ROUND() function to remove the decimal points and then multiply the result by 100. Using this technique, 1234567 bytes would be rounded to a bin of 1200 KB.

  ```sql
  /* This query will process 26 GB when run. */
  WITH requests AS (
    SELECT
      ROUND(CAST(JSON_VALUE(summary, '$.respBodySize') AS INT64)/1024/100)*100 AS responseSize100KB,
      COUNT(0) OVER () AS total_requests
    FROM
      `httparchive.all.requests` TABLESAMPLE SYSTEM (1 PERCENT)
    WHERE
      date = '2024-06-01'
      AND client = 'desktop'
      AND is_root_page
      AND CAST(JSON_VALUE(summary, '$.respBodySize') AS INT64) > 0
  )

  SELECT
    responseSize100KB,
    COUNT(0) AS requests,
    COUNT(0)/ANY_VALUE(total_requests) AS pct_requests
  FROM requests
  GROUP BY
    responseSize100KB
  ORDER BY
    responseSize100KB ASC
  LIMIT 10
  ```

  </TabItem>
  <TabItem label="Results">

  responseSize100KB | requests | pct_requests
  -- | -- | --
  100.0 | 1243361 | 0.6584621984027792
  200.0 | 268547 | 0.14221778549791345
  300.0 | 106798 | 0.056558349397335138
  400.0 | 64930 | 0.03438579024297244
  500.0 | 41220 | 0.021829389709153303
  600.0 | 28935 | 0.015323468977058488
  700.0 | 21860 | 0.011576672951045397
  800.0 | 25998 | 0.013768085241595526
  900.0 | 11734 | 0.0062141207871713941
  1000.0 | 9785 | 0.005181964539157328

  We can see that that 66% of requests have a response size less than 100KB. Try repeating this with 10KB bin sizes and you'll be able to see the spread of response sizes with more granularity.

  </TabItem>
</Tabs>

### Popularity of various image formats

<Tabs>
  <TabItem label="Query">

  Let's filter out all of the non-Image content and examine the popularity of various image formats. For example, how often is jpg, gif, webp, etc used.

  ```sql
  /* This query will process 8 GB when run. */
  WITH requests AS (
    SELECT
      JSON_VALUE(summary, '$.format') AS format,
      page,
      COUNT(0) OVER() AS total_requests,
      COUNT(DISTINCT page) OVER() AS total_pages
    FROM
      `httparchive.all.requests` TABLESAMPLE SYSTEM (1 PERCENT)
    WHERE
      date = '2024-06-01'
      AND client = 'desktop'
      AND is_root_page
      AND type = "image"
  )

  SELECT
    format,
    COUNT(0) requests,
    COUNT(DISTINCT page) pages,
    ROUND(COUNT(0) / ANY_VALUE(total_requests), 2) percent_image_requests,
    ROUND(COUNT(DISTINCT page) / ANY_VALUE(total_pages), 2) percent_pages
  FROM
    requests
  GROUP BY
    format
  ORDER BY
    requests DESC
  ```

  </TabItem>
  <TabItem label="Results">

  format | requests | pages | percent_image_requests | percent_pages
  -- | -- | -- | -- | --
  jpg | 1644804 | 1310081 | 0.38 | 0.43
  png | 1328825 | 1151809 | 0.31 | 0.38
  gif | 793541 | 495055 | 0.18 | 0.16
  svg | 250130 | 227550 | 0.06 | 0.08
  webp | 223783 | 191184 | 0.05 | 0.06
  ico | 64468 | 64016 | 0.01 | 0.02
  avif | 29226 | 25794 | 0.01 | 0.01
  | 4405 | 3938 | 0.0 | 0.0
  heic | 395 | 382 | 0.0 | 0.0

  :::note
  It's important to understand the bias in the data when doing this type of analysis. While 1.3 million page views is a very diverse set - the technology used to parse these pages is Chrome browsers (both Desktop and Emulated mobile). Because of this, some formats may be under-represented - since Chrome supports webp but not jpeg-xr or jpeg2000. There may be cases like this with other type of technologies as well - for example custom web font types that vary based on browser support.
  :::

  </TabItem>
</Tabs>

## Schema

Field name | Type | Description
---|---|---
[`date`](#date) | `DATE` | YYYY-MM-DD format of the HTTP Archive monthly crawl
[`client`](#client) | `STRING` | Test environment: `'desktop'` or `'mobile'`
[`page`](#page) | `STRING` | The URL of the page being tested
[`is_root_page`](#is_root_page) | `BOOLEAN` | Whether the page is the root of the origin
[`root_page`](#root_page) | `STRING` | The URL of the root page being tested, the origin followed by `/`
[`url`](#url) | `STRING` | The URL of the request
[`is_main_document`](#is_main_document) | `BOOLEAN` | Whether this request corresponds with the main HTML document of the page, which is the first HTML request after redirects
[`type`](#type) | `STRING` | Simplified description of the type of resource (script, html, css, text, other, etc)
[`index`](#index) | `INTEGER` | The sequential 0-based index of the request
[`payload`](#payload) | `STRING` | JSON-encoded WebPageTest result data for this request
[`summary`](#summary) | `STRING` | JSON-encoded summarization of request data
[`request_headers`](#request_headers) | <code>ARRAY&lt;<a href="/reference/structs/header/">Header</a>></code> | Request headers
[`response_headers`](#response_headers) | <code>ARRAY&lt;<a href="/reference/structs/header/">Header</a>></code> | Response headers
[`response_body`](#response_body) | `STRING` | Text-based response body

### `date`

**This field is required for all queries over the `requests` table.**

YYYY-MM-DD format of the HTTP Archive monthly crawl.

  Example: `date = '2023-06-01'`

### `client`

Test environment: `'desktop'` or `'mobile'`.

### `page`

The URL of the page being tested.

Example: `page = 'https://har.fyi/'`

### `is_root_page`

Whether the page is the root of the origin.

### `root_page`

The URL of the root page being tested, the origin followed by `/`.

Example: `root_page = 'https://har.fyi/'`

### `url`

The URL of the request

### `is_main_document`

Whether this request corresponds with the main HTML document of the page, which is the first HTML request after redirects

### `type`

Simplified description of the type of resource (script, html, css, text, other, etc)

### `index`

The sequential 0-based index of the request

### `payload`

JSON-encoded WebPageTest result data for this request

### `summary`

JSON-encoded summarization of request data

### `request_headers`

Request headers

### `response_headers`

Response headers

### `response_body`

Text-based response body
